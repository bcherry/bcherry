// C Source File
// Created 16/11/2003; 17:55:23

//#define USE_TI92PLUS              // Compile for TI-89
#define USE_TI89

#define OPTIMIZE_ROM_CALLS // Use ROM Call Optimization

#define MIN_AMS 100           // Compile for AMS 1.00 or higher

#define SAVE_SCREEN           // Save/Restore LCD Contents

#define TIR_MAX 5

#define ENNEMIS_MAX 20//10
#define ENNEMI_TYPE_1 5//3 20
#define ENNEMI_TYPE_2 2//1
#define ENNEMI_TYPE_3 2
#define ENNEMI_TYPE_4 6

#define ETOILES_MAX 10
#define DESCENTE 4900

#define DEPART_1 100
#define DEPART_5 2500

#define DEPART_2 5100
#define DEPART_3 10000
#define DEPART_4 15000

#include <tigcclib.h>         // Include All Header Files
#include "graphx.h"

/* ========== Maquette ========== */
void affichage(short *x, short *y, short choix);
//int gestion_tir(short mode);
void ennemis(void);
void controle_tir(void);		
void collision(short puissance);
void controle_collision(short *posx, short *posy);
void affiche_fond(short *x, short *y);
void affiche_planete_mort(short *x, short *y);
void descente(short *x, short *y);	/* ========== Sprites ========== */
	
	/* Vaisseau héro */
	
	
	//static long a_bas_data[] = {0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00300000,0x00300000,0x0E260000,0x1E3E0000,0x15BDC000,0x1DBFC000,0x1AC23000,0x1FC63800,0x15780000,0x3FF90600,0x1ABE0000,0x3FFE0000,0x3D730000,0x3FFB0000,0x33B3C000,0x3FFBC000,0x7C73E000,0x7FFFE000,0x73987000,0x7FFE7800,0x286A0000,0x7FFF9800,0x453D4000,0x7FFFFC00,0x80DFA804,0xD7FFFF84,0x013E7E81,0xADFE7FF9,0x00F000D0,0x02F000FF,0xC830001E,0xC838001E,0x38040000,0x38070000,0x07800000,0x07800000,0x00900000,0x00900000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000};
	static unsigned long a_bas_data[]={0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFCFFFFF,0x00300000,0x00300000,
	0xE1C1FFFF,0x0E260000,0x1E3E0000,
	0xE0403FFF,0x17FDC000,0x1DBFC000,
	0xE001C7FF,0x1AFA3000,0x1FC63800,
	0xC000F9FF,0x157E0000,0x3FF90600,
	0xC001FFFF,0x1ABE0000,0x3FFE0000,
	0xC000FFFF,0x3D770000,0x3FFB0000,
	0xC0003FFF,0x33B7C000,0x3FFBC000,
	0x80001FFF,0x7C73E000,0x7FFFE000,
	0x800007FF,0x7399F000,0x7FFE7800,
	0x800007FF,0x286A6600,0x7FFF9800,
	0x800003FF,0x453D4380,0x7FFFFC00,
	0x0000007B,0xA8DFA87C,0xD7FFFF84,
	0x50018006,0x533E7E87,0xADFE7F81,
	0xFD0FFF00,0xFCF000D0,0x02F000D0,
	0x07C7FFE1,0xF830001E,0xC838001E,
	0xC7F8FFFF,0x38040000,0x38070000,
	0xF87FFFFF,0x07800000,0x07800000,
	0xFF6FFFFF,0x00F00000,0x00900000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000};

	//static long a_haut_data[] = {0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00006000,0x00030000,0x00038000,0x003C0000,0x003C0000,0x01C00000,0x01F00000,0x03C00009,0x03C00009,0x00F00000,0x02F8000F,0x0FCCF002,0x0FDCF07E,0x7D83E0F0,0x7FCFEFF0,0xAAE78580,0xFFF79F80,0x55722E00,0x7FF27E00,0x2AF95800,0x3FFFF800,0x1796E000,0x7FFFE000,0x7E7D8000,0x7FFF8000,0x399E0000,0x3FFE0000,0x3E7E0C00,0x3FFE1C00,0x18BFE000,0x1FFFE000,0x1D1E0000,0x1FFE0000,0x1A100000,0x1F700000,0x08000000,0x0EC00000,0x00000000,0x0D430000,0x00F00000,0x08F00000,0x0F000000,0x0F000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000};
	static unsigned long a_haut_data[]={0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFF9FFF,0x00000000,0x00006000,
	0xFFFC7FFF,0x00030000,0x00038000,
	0xFFC3FFFF,0x003C0000,0x003C0000,
	0xFE0FFFFF,0x03C00000,0x01F00000,
	0xFC3FFFF6,0x03FC001F,0x03C00009,
	0xFC07FFF0,0x01F00070,0x02F8000F,
	0xF0030F81,0x0FECFF82,0x0FDCF07E,
	0x8000000F,0x7DB3F0F0,0x7FCFEFF0,
	0x0000007F,0xAAEFE580,0xEFF79F80,
	0x800001FF,0x557FAE00,0x7FF27E00,
	0xC00007FF,0x2AF95800,0x3FFFF800,
	0x80001FFF,0x1796E000,0x7FFFE000,
	0x80007FFF,0x7E7D8000,0x7FFF8000,
	0xC001FFFF,0x399E0000,0x3FFE0000,
	0xC001E3FF,0x3E7E2C00,0x3FFE1C00,
	0xE0001FFF,0x18BFE000,0x1FFFE000,
	0xE001FFFF,0x1D1E0000,0x1FFE0000,
	0xE00FFFFF,0x1A900000,0x1E700000,
	0xF03FFFFF,0x09040000,0x0EC00000,
	0xF03CFFFF,0x028C0000,0x0D430000,
	0xF00FFFFF,0x07F00000,0x08F00000,
	0xF0FFFFFF,0x0F000000,0x0F000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000};

	//static long a_horizon_data[] = {0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00100000,0x00000000,0x85580000,0x80800000,0xFF810000,0x04000000,0x7C008000,0x455E0000,0x7FFE0000,0x0AA80000,0x3FF80000,0x2D580000,0x3FFE0018,0x3AA80000,0x3FF9FCFE,0x25580042,0x2FFFFFFE,0x67FD55F8,0x7FFFFFF8,0x1FFABE00,0x3FFFFE00,0x3015E000,0x3FFFE000,0x601E0000,0x6FFE0000,0x58180000,0x7FF80000,0x88100000,0xFD500000,0x98080000,0xFABC0000,0x08000000,0x0D100000,0x04000000,0x04110000,0x04000000,0x04008000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000};
	static unsigned long a_horizon_data[]={0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFEFFFFF,0x00000000,0x00100000,
	0x0007FFFF,0x7AA00000,0x85580000,
	0x007EFFFF,0x80800000,0xFF810000,
	0x80007FFF,0x07FF0000,0x7C008000,
	0x8001FFFF,0x455E0000,0x7FFE0000,
	0xC007FFFF,0x0AA80000,0x3FF80000,
	0xC0000F83,0x2D59F064,0x3FFE0018,
	0xC0000001,0x3AAE0300,0x3FF9FCFE,
	0x80000001,0x75580042,0x2FFFFFFE,
	0x80000007,0x67FD55F8,0x7FFFFFF8,
	0xC00001FF,0x1FFABE00,0x3FFFFE00,
	0x80001FFF,0x7015E000,0x3FFFE000,
	0x8000FFFF,0x701E0000,0x6FFE0000,
	0x8007FFFF,0x58180000,0x7FF80000,
	0x000FFFFF,0x8AB00000,0xFD500000,
	0x0003FFFF,0x9D480000,0xFABC0000,
	0xF00FFFFF,0x0AE00000,0x0D100000,
	0xF80EFFFF,0x07E00000,0x04110000,
	0xF8007FFF,0x07FF0000,0x04008000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000,
	0xFFFFFFFF,0x00000000,0x00000000};	

	/* Vaisseau héro 2 */
	//static long b_horizon_data[] = {0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00FFE000,0x00001800,0x03003800,0x06000600,0x06001E00,0x39002180,0x3FFFFF80,0x4876F93E,0x78FFFFFE,0x78F6BE8E,0x7EFFBFFE,0x913F3FF8,0x913F3FF8,0x11252000,0x71F52006,0xFF6FFFDF,0xFFFFFFDF,0x71FF3430,0x7FFFFE30,0x93AAC1C0,0xFFFFF1C0,0x93500E00,0xFFFD4E00,0x5E003000,0x7EAA3000,0x4001C000,0x5551C000,0x200E0000,0x200E0000,0x3FF00000,0x3FF00000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000};
	//GX_sprite_32_nomask *b_horizon = (GX_sprite_32_nomask *)b_horizon_data;
	

	static long b_horizon_data[] = {0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFF001FFF,0x00000000,0x00FFE000,0xFC0007FF,0x00001800,0x03003800,0xF80001FF,0x06000600,0x06001E00,0xC000007F, 0x39002180,0x3FFFFF80,0x80000001,0x4876F93E,0x78FFFFFE,0x80000001,0x78F6BE8E,0x7EFFBFFE,0x80000007, 0x913F3FF8,0x913F3FF8,0x00000000, 0x11252000,0x71F52006,0x00000000, 0xFF6FFFDF,0xFFFFFFDF,0x0000000F, 0x71FF3430,0x7FFFFE30,0x0000003F, 0x93AAC1C0,0xFFFFF1C0,0x000000FF, 0x93500E00,0xFFFD4E00,0x80000FFF, 0x5E003000,0x7EAA3000,0x80003FFF, 0x4001C000,0x5551C000,0xC001FFFF, 0x200E0000,0x200E0000,0xC00FFFFF, 0x3FF00000,0x3FF00000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000,0xFFFFFFFF, 0x00000000,0x00000000};
	static long b_bas_data[] = {0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFFFFFFFF,0x00000000,0x00000000,0xFF1FFFFF, 0x00000000,0x00E00000,0xFC01FFFF, 0x01000000,0x030E0000,0xF8003FFF, 0x00000000,0x0701C000,0xC0001FFF, 0x3F800000,0x3FF02000,0x00000FFF, 0x19601000,0x99FE7000,0x000003FF, 0x92EC0C00,0xF6FFFC00,0x000001FF, 0xD1EEE200,0xF3FFFE00,0x8000007F, 0x7B3FF580,0x7BBFFF80,0x8000003F, 0x3727A840,0x7FE7BFC0,0x8000000F, 0x27E53EB0,0x7FFD3FF0,0x00000001, 0xA43EA3CE,0xFFFFA3FE,0x00000001, 0x98067C7E,0xBFFFFC7E,0x00000007, 0x8001C398,0x815FFF98,0x00000001, 0xE000007A,0xE02A007E,0x00000071, 0x1E00FF8E,0x1E00FF8E,0xFE00FFFF, 0x01FF0000, 0x01FF0000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000, 0x00000000, 0xFFFFFFFF, 0x00000000,  0x00000000};
	static long b_haut_data[] = {0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFF07FE7, 0x00000000,0x000F8018, 0xFF800007, 0x00007F88,0x0071FFF8, 0xFC000000, 0x00000867,0x0380FFE7, 0xF8000000, 0x0001F2F1,0x040FFFF1, 0xF0000001, 0x0C27DF8E,0x0CFFDF8E, 0xC0000007, 0x32DBCC78,0x3FFFEE78, 0x8000001F, 0x7FDE67A0,0x7FFF7FA0, 0x0000003F, 0xB9E96C40,0xF9EBFE40, 0x0000007F, 0xD089F180,0xF29FF980, 0x000001FF, 0xB88F0200,0xFCFFF200, 0x000003FF, 0xE5B80400,0xEDFFA400, 0x800007FF, 0x46C01800,0x5FFE9800, 0x80001FFF, 0x44402000,0x7FF52000, 0x80003FFF, 0x5E804000,0x7FD84000, 0xC0007FFF, 0x37008000,0x3FA08000, 0xF000FFFF, 0x09010000,0x0F010000, 0xF001FFFF, 0x08060000,0x0D060000, 0xF807FFFF, 0x06380000,0x06380000, 0xFE3FFFFF, 0x01C00000,0x01C00000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000};
	
	/* Ennemi 1 */																																																																																																																																																
//	static short ennemi1_data[] = {0xFE0F, 0x00F0,0x01F8, 0xFE07, 0x01F8,0x0390, 0xFC03, 0x0248,0x003C, 0xE003, 0x0CAC,0x0350, 0xE001, 0x1F84,0x0FDA, 0xC001, 0x3FD6,0x1F88, 0xC000, 0x3FC2,0x3FFD, 0x8000, 0x7FE0,0x3FEF, 0x8001, 0x79E4,0xFEFA, 0x0003, 0x78F0,0xBBE4, 0x8003, 0x7FE0,0x79E8, 0xC007, 0x3FE0,0x7FD0, 0xC007, 0x3FC0,0x3FD0, 0xE03F, 0x1FC0,0x3F80, 0xE03F, 0x1F80,0x1F80, 0xE07F, 0x0000,0x0F00};
	static unsigned short ennemi1_data[]={0xF00F,0x01F0,0x0E00,
	0xE007,0x1FF8,0x0FF0,
	0xE007,0x1FF8,0x0FF0,
	0xE007,0x1BD8,0x1FF8,
	0xC003,0x399C,0x1FF8,
	0xC003,0x3DBC,0x1FF8,
	0xC003,0x3C3C,0x1E7C,
	0x8001,0x7C1E,0x3DBC,
	0x8001,0x7C1E,0x3DBC,
	0xC003,0x3C3C,0x1E7C,
	0xC003,0x3DBC,0x1FF8,
	0xC003,0x399C,0x1FF8,
	0xE007,0x1BD8,0x0FF0,
	0xE007,0x1FF8,0x0FF0,
	0xE007,0x1FF8,0x0FF0,
	0xF00F,0x0C10,0x03E0};	

	/* Ennemi 2 */
	static long tete_data[] = {0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFFFFFF, 0x00000000,0x00000000, 0xFFFE0FFF, 0x00000000,0x0001F000, 0xFFF007FF, 0x00000000,0x000F0800, 0xFFC003FF, 0x00038000,0x003C3C00, 0xFF8003FF, 0x0005C000,0x006A7400, 0xFF0003FF, 0x0040C400,0x008FE000, 0xFE0003FF, 0x0011C400,0x01EEE000, 0xFE0003FF, 0x0041E400,0x01BED000, 0xFE0003FF, 0x004FFC00,0x03F1B000, 0xFE0003FF, 0x003F1C00,0xC3CFE400, 0xFE0003FF, 0x3C1E0400,0xE6FDBC00, 0xFE0003FF, 0xFF1FF800,0xC0A00400, 0xF800CFFF, 0x03AF0000,0x04DF3000, 0xF800FFFF, 0x022F0000,0x05CF0000, 0xF8007FFF, 0x024F8000,0x05078000, 0xFC003FFF, 0x01C78000,0x0203C000};

	//static long jambes1_data[] = {0x0003D000,0x00800800,0x0003D000,0x00800800,0x00028000,0x00015C00,0x0005A800,0x00020380,0x00048800,0x000371E0,0x00055038,0x0002A800,0x0003FE48,0x00009FA0,0x0000FFE8,0x0001FF18,0x00003FC0,0x00007878,0x00000FC0,0x00001EE8,0x000003E0,0x0000074C,0x000001E4,0x0000010C,0x000000E4,0x000001CC,0x000000E4,0x0000003E,0x00000064,0x0000007E,0x0000002E,0x0000006C,0x0000002E,0x00000015,0x0000001B,0x00000037,0x00000006,0x0000003F,0x0000001F,0x0000005D,0x0000004F,0x000001BD,0x0000018E,0x000006C2,0x00000C0E,0x00000102,0x0000018E,0x00003302,0x0000018E,0x0000FF82,0x0000818C,0x00007E06,0x0000000C,0x00000006,0x0000000E,0x00000004,0x0000000E,0x00000032,0x00000046,0x0000003A,0x00000183,0x0000007C,0x000001FF,0x000001FF};
	static unsigned long jambes1_data[]={0xFFFC07FF,0x00000800,0x0003D000,
	0xFFFC07FF,0x00000800,0x0003D000,
	0xFFFC03FF,0x00015C00,0x00028000,
	0xFFF8007F,0x00020380,0x0005A800,
	0xFFF8001F,0x000371E0,0x00048800,
	0xFFF80007,0x0002A800,0x00055038,
	0xFFFC0007,0x00009FA0,0x0003FE48,
	0xFFFE0007,0x0001FF18,0x0000FFE8,
	0xFFFF8007,0x00007878,0x00003FC0,
	0xFFFFE007,0x00001EE8,0x00000FC0,
	0xFFFFF803,0x0000074C,0x000003E0,
	0xFFFFFE03,0x0000010C,0x000001E4,
	0xFFFFFE03,0x000001CC,0x000000E4,
	0xFFFFFF01,0x0000003E,0x000000E4,
	0xFFFFFF81,0x0000007E,0x00000064,
	0xFFFFFF81,0x0000006C,0x0000002E,
	0xFFFFFFC0,0x00000015,0x0000002E,
	0xFFFFFFC0,0x00000037,0x0000001B,
	0xFFFFFFC0,0x0000003F,0x00000006,
	0xFFFFFF80,0x0000005D,0x0000001F,
	0xFFFFFE00,0x000001BD,0x0000004F,
	0xFFFFF831,0x000006C2,0x0000018E,
	0xFFFFF0F1,0x00000102,0x00000C0E,
	0xFFFFC071,0x00003302,0x0000018E,
	0xFFFF0071,0x0000FF82,0x0000018E,
	0xFFFF0071,0x00007E06,0x0000818C,
	0xFFFFFFF1,0x00000006,0x0000000C,
	0xFFFFFFF1,0x00000004,0x0000000E,
	0xFFFFFFC1,0x00000032,0x0000000E,
	0xFFFFFF81,0x0000003A,0x00000046,
	0xFFFFFE00,0x0000007C,0x00000183,
	0xFFFFFE00,0x000001FF,0x000001FF};	

	//static long jambes2_data[] = {0x07800000,0x03C00000,0x04018000,0x0BCE4000,0x08B04000,0x1341C000,0x002FC000,0x17928000,0x0711E000,0x3452E000,0x14507800,0x23B02000,0x17304600,0x08833B00,0x0FE04700,0x07E06500,0x003E6700,0x07F19D00,0x001F8780,0x001FFF80,0x00000780,0x0000DF80,0x000007E0,0x00005FE0,0x00001BE0,0x00005E70,0x000019F0,0x00003B00,0x00000194,0x0000A0FC,0x00000096,0x0000E07E,0x0000206E,0x0000407E,0x0000007E,0x0000401E,0x0000401E,0x0001000E,0x0001600E,0x0000801E,0x0000200E,0x0003D80A,0x0000C00E,0x001C600A,0x0001000E,0x0032800A,0x0062000C,0x009C0006,0x00B0000C,0x03700006,0x0300000C,0x07A0000E,0x0020000C,0x1B60000E,0x0070000E,0xF7A00010,0xF7F0006E,0xC8200012,0x00000086,0x0000037A,0x00000207,0x000005F8,0x000007FF,0x00001FFF};
	unsigned long jambes2_data[]={0xFC01FFFF,0x017E0000,0x03FE0000,
	0xF8007FFF,0x05C88000,0x02030000,
	0xF0007FFF,0x09438000,0x04B08000,
	0xF0007FFF,0x0B950000,0x002F8000,
	0xE0003FFF,0x1A55C000,0x0313C000,
	0xE0001FFF,0x11B04000,0x0A50E000,
	0xF00003FF,0x04824C00,0x0B309800,
	0xF80003FF,0x03E0D400,0x07E09C00,
	0xFC0003FF,0x03F33400,0x003CDC00,
	0xFFE001FF,0x001FFE00,0x001F1E00,
	0xFFFE01FF,0x0001BE00,0x00001E00,
	0xFFFF00FF,0x0000BF00,0x00001F00,
	0xFFFF007F,0x0000B980,0x00002F00,
	0xFFFF907F,0x00006C00,0x00002780,
	0xFFFEB81F,0x000143E0,0x000006A0,
	0xFFFEBC0F,0x000141E0,0x000002B0,
	0xFFFF3E0F,0x000081F0,0x00004170,
	0xFFFF7E0F,0x000080F0,0x000001F0,
	0xFFFD7F0F,0x00020070,0x000080F0,
	0xFFFC3F0F,0x000100F0,0x0002C070,
	0xFFF81F8F,0x00072050,0x00004070,
	0xFFE03F8F,0x0018C050,0x00018070,
	0xFFC0FF8F,0x00350050,0x00020070,
	0xFF03FF8F,0x00980030,0x00640060,
	0xFE0FFF8F,0x00700030,0x01B00060,
	0xFC1FFF8F,0x02A00070,0x01000060,
	0xF01FFF8F,0x0D600070,0x00200060,
	0xC00FFF0F,0x3BA00080,0x00700070,
	0xC00FFE0F,0x24200090,0x3BF00170,
	0xFFFFF00F,0x00000DD0,0x00000230,
	0xFFFFE007,0x000017C0,0x00000838,
	0xFFFFC007,0x00003FF8,0x00001FF8};	

	//static long jambes3_data[] = {0x03F00000,0x03E50000,0x03F00000,0x03E50000,0x02018000,0x05E28000,0x0420C000,0x0DF44000,0x0C18E000,0x03F75000,0x0C5CF000,0x07A7D000,0x0237F200,0x05A3FE00,0x01E3FE00,0x0201F300,0x00017700,0x00C0BD00,0x00000F80,0x00301E00,0x0000C7C0,0x00092800,0x000123C0,0x0006A440,0x00012160,0x0001C280,0x0000A0B0,0x00015140,0x000020D0,0x00016020,0x0000407C,0x00020008,0x0000803C,0x00024028,0x0000801C,0x00020038,0x0000801C,0x00050018,0x0001001C,0x00050018,0x0001001C,0x00040002,0x0002001C,0x00090002,0x0002800C,0x000D4006,0x0001800C,0x001C0006,0x0004000C,0x00280006,0x0008000C,0x007C0006,0x0120000E,0x02C00012,0x00C00026,0x07C0005A,0x040001DE,0x0E800022,0x018001FF,0x16800200,0x01800000,0xEE000000,0xEF800000,0xB9800000};
	static unsigned long jambes3_data[]={0xFC00FFFF,0x03EF0000,0x03F00000,
	0xFC00FFFF,0x03EF0000,0x03F00000,
	0xF8007FFF,0x05FE0000,0x02018000,
	0xF0003FFF,0x0DDF0000,0x0420C000,
	0xF0000FFF,0x03F75000,0x0C18E000,
	0xF0000FFF,0x07A7D000,0x0C5CF000,
	0xF80001FF,0x05ABFE00,0x0237F200,
	0xFC0000FF,0x020DE300,0x01E3FE00,
	0xFF0000FF,0x00C6BD00,0x00017700,
	0xFFC0007F,0x0037FE00,0x00000F80,
	0xFFF0103F,0x000B2800,0x0000C7C0,
	0xFFF8183F,0x0006A440,0x000123C0,
	0xFFFE1C1F,0x0001C280,0x00012160,
	0xFFFE0E0F,0x00011140,0x0000E0B0,
	0xFFFE1F0F,0x0001E020,0x000020D0,
	0xFFFC3F83,0x00028008,0x0000407C,
	0xFFFC3FC3,0x00024028,0x0000803C,
	0xFFFC7FC3,0x00020038,0x0000801C,
	0xFFF87FE3,0x00050018,0x0000801C,
	0xFFF8FFE3,0x00050018,0x0001001C,
	0xFFF8FFE1,0x00040002,0x0001001C,
	0xFFF0FFE1,0x00090002,0x0002001C,
	0xFFF03FF1,0x000D4006,0x0002800C,
	0xFFE27FF1,0x001C0006,0x0001800C,
	0xFFC3FFF1,0x00280006,0x0004000C,
	0xFF83FFF1,0x007C0006,0x0008000C,
	0xFC1FFFE1,0x02C00012,0x0120000E,
	0xF83FFF81,0x05C0005A,0x02C00026,
	0xF07FFE01,0x0E000022,0x048001DE,
	0xE07FFC00,0x14800200,0x018001FF,
	0x007FFFFF,0xEE000000,0x01800000,
	0x007FFFFF,0xA1800000,0xFF800000};

	//static long jambes4_data[] = {0x03800000,0x06830000,0x04018000,0x0202F000,0x09E0F800,0x079DF000,0x0C71FC00,0x03AEC800,0x0C0DFC00,0x0B3BE000,0x06A61C00,0x085C3A00,0x07201E00,0x005C1200,0x03C01F00,0x017B0200,0x00388B00,0x00C18C00,0x00044F00,0x000B8000,0x00024780,0x00010000,0x0000C280,0x00030780,0x00004380,0x00028290,0x000041F0,0x0002C150,0x000001E0,0x00018160,0x000000E0,0x000181C0,0x000000C0,0x000181E0,0x00000140,0x00018180,0x00008180,0x00014080,0x00008380,0x00013000,0x00006300,0x0001F780,0x00006700,0x0001C580,0x0001CD00,0x00004780,0x0000C980,0x00030F80,0x00009380,0x00031C80,0x00011600,0x00062900,0x00003800,0x000E6C00,0x001C2000,0x00005000,0x00240000,0x00300000,0x00040000,0x00FC0000,0x000C0000,0x03360000,0x03FC0000,0x06240000};
	static unsigned long jambes4_data[]={0xF800FFFF,0x06830000,0x03800000,
	0xF8000FFF,0x0202F000,0x04018000,
	0xF00007FF,0x079DF000,0x09E0F800,
	0xF00003FF,0x03AEC800,0x0C71FC00,
	0xF00003FF,0x0B3BE000,0x0C0DFC00,
	0xF001C1FF,0x085C3A00,0x06A61C00,
	0xF803E1FF,0x005C1200,0x07201E00,
	0xFC00E0FF,0x017B0200,0x03C01F00,
	0xFF0070FF,0x00C18C00,0x00388B00,
	0xFFF030FF,0x000B8000,0x00044F00,
	0xFFFC387F,0x00010000,0x00024780,
	0xFFFC387F,0x00030780,0x0000C280,
	0xFFFC3C6F,0x00028290,0x00004380,
	0xFFFC3E0F,0x0002C150,0x000041F0,
	0xFFFE7E1F,0x00018160,0x000001E0,
	0xFFFE7E1F,0x000181C0,0x000000E0,
	0xFFFE7E1F,0x000181E0,0x000000C0,
	0xFFFE7E3F,0x00018180,0x00000140,
	0xFFFE3E7F,0x00014080,0x00008180,
	0xFFFE0C7F,0x00013000,0x00008380,
	0xFFFE087F,0x0001F780,0x00006300,
	0xFFFE187F,0x0001C580,0x00006700,
	0xFFFE307F,0x00004780,0x0001CD00,
	0xFFFC307F,0x00030F80,0x0000C980,
	0xFFFC607F,0x00031C80,0x00009380,
	0xFFF8C0FF,0x00062900,0x00011600,
	0xFFF183FF,0x000E6C00,0x00003800,
	0xFFE38FFF,0x00005000,0x001C2000,
	0xFFC3FFFF,0x00300000,0x00240000,
	0xFF03FFFF,0x00FC0000,0x00040000,
	0xFC01FFFF,0x03360000,0x000C0000,
	0xF803FFFF,0x06240000,0x03FC0000};	

	//static long jambes5_data[] = {0x00C08000,0x01A30000,0x01288000,0x00764000,0x0008C000,0x03D74000,0x028CF000,0x00AFE800,0x020BFC00,0x03F7D400,0x0191BC00,0x02C8B400,0x00F09C00,0x00FC7400,0x000C4400,0x00023C00,0x00033400,0x0000CC00,0x0000DE00,0x00008800,0x00005A00,0x00006E00,0x00002E00,0x00007200,0x00000F00,0x00002600,0x00000600,0x00002B00,0x00000600,0x00002400,0x00000680,0x00001300,0x00001380,0x00000580,0x00001300,0x00003E00,0x00007800,0x00003A00,0x0000F800,0x00001600,0x0001E580,0x0003C000,0x0003C300,0x00044680,0x0009C680,0x00168180,0x0020C080,0x001F4700,0x003FC100,0x007F4200,0x00000300,0x00000000,0x00000200,0x00000100,0x00000300,0x00000E00,0x00000800,0x00001F00,0x00000200,0x00003900,0x00010300,0x0000DC00,0x0001FF00,0x00008200};
	static unsigned long jambes5_data[]={0xFE007FFF,0x01A30000,0x00C08000,
	0xFE003FFF,0x00764000,0x01288000,
	0xFC003FFF,0x03D74000,0x0008C000,
	0xFC0007FF,0x00AFE800,0x028CF000,
	0xFC0003FF,0x03F7D400,0x020BFC00,
	0xFC0003FF,0x02C8B400,0x0191BC00,
	0xFF0003FF,0x00FC7400,0x00F09C00,
	0xFFF003FF,0x00023C00,0x000C4400,
	0xFFFC03FF,0x0000CC00,0x00033400,
	0xFFFF01FF,0x00008800,0x0000DE00,
	0xFFFF81FF,0x00006E00,0x00005A00,
	0xFFFF81FF,0x00007200,0x00002E00,
	0xFFFFC0FF,0x00002600,0x00000F00,
	0xFFFFC0FF,0x00002B00,0x00000600,
	0xFFFFC1FF,0x00002400,0x00000600,
	0xFFFFE07F,0x00001300,0x00000680,
	0xFFFFE07F,0x00000580,0x00001380,
	0xFFFFC0FF,0x00003E00,0x00001300,
	0xFFFF81FF,0x00003A00,0x00007800,
	0xFFFF01FF,0x00001600,0x0000F800,
	0xFFFC187F,0x0003C000,0x0001E580,
	0xFFF8387F,0x00044680,0x0003C300,
	0xFFE0387F,0x00168180,0x0009C680,
	0xFFC0387F,0x001F4700,0x0020C080,
	0xFF803CFF,0x007F4200,0x003FC100,
	0xFFFFFCFF,0x00000000,0x00000300,
	0xFFFFFCFF,0x00000100,0x00000200,
	0xFFFFF0FF,0x00000E00,0x00000300,
	0xFFFFE0FF,0x00001F00,0x00000800,
	0xFFFFC0FF,0x00003900,0x00000200,
	0xFFFE00FF,0x0000DC00,0x00010300,
	0xFFFE00FF,0x00008200,0x0001FF00};	
	
	/* Ennemi 3 */																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	
	//static long ennemi3_data[] = {0xFFF01FFF, 0x0007C000,0x0007E000,0xFF200FFF, 0x00503000,0x00503000,0xFC0000FF, 0x035FFF00,0x035FFF00,0xF800003F, 0x06B028C0,0x06B0E9C0,0xF000001F, 0x09511960,0x0951FBE0,0xF800003F, 0x088FE6A0,0x088FFFE0,0xFC00007F, 0x04345140,0x0437FF40,0xFFF00FFF, 0x03FFFF80,0x03FFFF80,0xFF80021F, 0x000FF000,0x000FF000,0xF800003F, 0x007FFCE0,0x007FFDE0,0xF000001F, 0x07800BC0,0x07FFFFC0,0xF000001F, 0x080005E0,0x0807FFE0,0xF800003F, 0x08003F60,0x0FFFFFE0,0xFC00003F, 0x0B7322A0,0x0FFFEFE0,0xFE00007F, 0x06EAA340,0x06EEEFC0,0xFE0001FF, 0x03DFA740,0x03DFE7C0,0xFC5019FF, 0x01FFFF80,0x01FFFF80,0xF9F02CFF, 0x016FD600,0x016FDE00,0xF3F8EE7F, 0x03AF2600,0x03AF2600,0xF3E9F73F, 0x040BD100,0x040BD300,0xF3DFFB9F, 0x08071080,0x08071180,0xF3A3FBCF, 0x08160840,0x081608C0,0xF97FFFDF, 0x08200420,0x08200460,0xFC7FFF9F, 0x08500410,0x08500430,0xFE7FFF3F, 0x04800000,0x04800020,0xFF3FF87F, 0x02000020,0x02000060,0xFF7FF6FF, 0x01000040,0x010000C0,0xFF1FECFF, 0x00400080,0x00400780,0xFF6FFBFF, 0x00000100,0x00000900,0xFF6FFBFF, 0x00800000,0x00801300,0xFF3FFFFF, 0x00000000,0x00000400,0xFF3FFFFF, 0x00000000,0x00000000};
	unsigned short ennemi3_data[]={0xF03B,0x0C00,0x03C0,
	0x4007,0x1448,0x1FE0,
	0x4002,0x020C,0x3DF8,
	0x4001,0x27D8,0x1FF0,
	0xE003,0x17D8,0x0FE0,
	0x4002,0x001C,0x19F8,
	0x4002,0x001C,0x3DF8,
	0x4001,0x3BF0,0x1F98,
	0xA001,0x0F88,0x1FD0,
	0x400F,0x2D60,0x1310,
	0x4801,0x0470,0x2308,
	0x40D2,0x0A08,0x2424,
	0x04E2,0x0804,0x1008,
	0xA305,0x0820,0x0018,
	0xC00F,0x0860,0x0010,
	0xE057,0x0800,0x0000};	

	/* Ennemi 4 */
	static long ennemi4_data[] = {0x00004000,0x00000000,0x00006000,0x0000C000,0x0000E000,0x0000E000,0x0007A000,0x0008F000,0x0009E000,0x0006A000,0x001FE000,0x000E4000,0x001E6000,0x000DC000,0x000DE000,0x001EE000,0x0007F000,0x000FF000,0x000FF000,0x000FF000,0x001FF800,0x003FE000,0x001FF000,0x001FE800,0x001FF800,0x002D6000,0x001D7000,0x0027E800,0x003FF000,0x003F2800,0x001FF000,0x003E1800,0x001FF000,0x00399800,0x000FF800,0x001F2000,0x000FF800,0x000FF000,0x000EF000,0x000DF800,0x000EF000,0x000FF000,0x000F7000,0x000A8000,0x000F2000,0x000AE000,0x000FC000,0x000BE000,0x000FE000,0x000FF000,0x000FA000,0x0005C400,0x0007E000,0x00012C00,0x0007E000,0x00068000,0x000FE400,0x0006A000,0x000EE000,0x001BE000,0x001DE000,0x000E2000,0x0001C000,0x0000C000};

	/* Ennemi 5 */	
	static short ennemi5_data[] = {0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFF83, 0x0000,0x0020, 0xFC03, 0x0040,0x00BC, 0xF001, 0x01CC,0x0230, 0x0001, 0x07DC,0x1822, 0x0000, 0x0000,0x7FDE, 0x0000, 0x00A0,0x0056, 0xFF00, 0x00B0,0x0046, 0x0000, 0x0000,0x7F86, 0x0001, 0x07CC,0x1832, 0xF001, 0x01CC,0x0230, 0xFC03, 0x0040,0x00BC, 0xFF83, 0x0000,0x0038, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000};

	/* Armes */
	static short laser_data[] = {0xFFFF,0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0x0000, 0x07FF,0xF81F, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000, 0xFFFF, 0x0000,0x0000};

	/* Explosions */	
	static short ex1_data[] = {0x0000, 0x0000,0x0000,0x0000,0x0000,0x0400,0x00C0,0x00C0,0x0068,0x2468,0x0260,0x03E0,0x0630,0x07F0,0x1518,0x17F8,0x1810,0x1FF0,0x1810,0x1FF0,0x0E30,0x0FF0,0x03F0,0x03F0,0x0924,0x0924,0x0000,0x0000,0x0080,0x0080,0x0000,0x0000};
	static short ex2_data[] = {0x03C0,0x03E0,0x03C0,0x03E0,0x0A38,0x0BF8,0x798C,0x7FEC,0xEB0A,0xEFBA,0xB256,0xF776,0xE26F,0xFBFF,0x6C87,0x7DFF,0x640F,0x7DEF,0x640F,0x7DEF,0x343F,0x3EFF,0x1E72,0x1F7A,0x178E,0x1FBE,0x288C,0x3BCC,0x1668,0x17E8,0x0780,0x0780};
	static short ex3_data[] = {0x03E0,0x0000,0x03E0,0x0000,0x0BF8,0x0000,0x7FEC,0x0000,0xEFBA,0x0000,0xF77E,0x0000,0xFBFF,0x0000,0x7DFF,0x0000,0x7DEF,0x0000,0x7DEF,0x0000,0x3EFF,0x0000,0x1F7B,0x0000,0x1FBE,0x0000,0x3BCC,0x0000,0x17E8,0x0000,0x0780,0x0000};
	static short ex4_data[] = {0x0F00,0x0F00,0x3800,0x3800,0x6060,0x6060,0x4038,0x4038,0xC01C,0xC01C,0x800C,0x800C,0x820E,0x820E,0xC006,0xC006,0x480D,0x480D,0x2089,0x2089,0x0011,0x0011,0x0002,0x0002,0x2042,0x2042,0x1804,0x1804,0x0718,0x0718,0x00E0,0x00E0};
	
	/* Vie */
	short vie_data[] = {0xFF,0xFF,0x81,0xFF,0x81,0xFF,0x81,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00};

	static short etoile_data[] = {0x00,0x00,0x00,0x00,0x04,0x04,0x0C,0x12,0x10,0x1C,0x05,0x4B,0x00,0x00,0x00,0x00};


/* ========= Ecrans ========== */
GX_HANDLE ecr, fond;


// Structure ennemis
struct ENNEMI  {
								 short posx, posy, vie;		
								 short tracex, tracey;
								 short tirx, tiry;
							 }ennemi[ENNEMIS_MAX];
							 							 
unsigned long compteur = 0;
short exploennemi = (-1), explocompt = 100;
short vie = 16;
short quitte = 0;
short pas_mode = 12;
short maxy;
//char buffer_vie[9];
	
	
struct TIR { short posx; 
						 short posy;
					 }tir[TIR_MAX];

// Main Function
void _main(void)
{

	short posx = 10, posy = ((LCD_HEIGHT-32)/2);
	short variation = /*2*/200, tir_ok = 0;
	short i=0;
	short mortx = LCD_WIDTH, morty = 20;
	short minvar = /*1*/201, maxvar = /*3*/203;

	struct ETOILES { short posx;
									 short posy; 
								 }etoile[ETOILES_MAX];


	for(i=0 ; i<(ETOILES_MAX-1) ; i++)
	{
		etoile[i].posx = (random(LCD_WIDTH)+LCD_WIDTH);
		etoile[i].posy = random(LCD_HEIGHT-20);
	}
	compteur = 0;
	vie = 16;
	quitte = 0;
	for(i=0 ; i<(TIR_MAX-1) ; i++)
		tir[i].posx = LCD_WIDTH+1;
	for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
	{
		ennemi[i].posx = (LCD_WIDTH+random(50));
		ennemi[i].posy = random(LCD_HEIGHT-32);
		ennemi[i].vie = 6;		
		ennemi[i].tracex = 0;
		ennemi[i].tracey = 0;
		ennemi[i].tirx = (-40);
	}


	if(!GX_PowerOn(TRUE))
		return;
	
	ecr = GX_CreateBuffer();
	if(ecr == H_NULL)
	{
		GX_PowerOff(TRUE);
		return;
	}

	fond = GX_CreateBuffer();
	if(fond == H_NULL)
	{
		GX_PowerOff(TRUE);
		return;
	}
	
	//sprintf(buffer_vie, "VIE : %03d", vie);	

	GX_SetWorkBuffer(fond);
	GX_Clear();	
	
	for(explocompt = 0 ; explocompt < (10*vie) ; explocompt+=10)
	{
		affichage(&explocompt, &explocompt, 105);
	}			
	
	GX_SetWorkBuffer(ecr);
	
	maxy = 10;//tirplusy = 10;
	
	/* ===== Boucle principale ===== */
	
	while((!GX_ESCAPEpressed())&&(!quitte))
	{
		GX_joypad touche;	
		touche = GX_ReadJoypad();
		
		
		if(compteur > DESCENTE)
			variation=2;
		else
			variation=202;			
		//if(compteur&2)
		//{
			if(touche.up)// Touche haut préssée
			{
				if(posy > (-5))
				{
					if(variation > /*1*/minvar)
						variation-=1;
						posy--;					
				}
			}
			else if(touche.down)// Touche bas préssée
			{
				if(posy < LCD_HEIGHT-32)
				{
					if(variation < /*3*/maxvar)
						variation+=1;		
						posy++;						
				}
			}		
			//else
		
		//}

		if(touche.left)// Touche gauche préssée
		{
			if(posx > 0)
			{
				if(compteur&2)
					posx--;					
			}
		}
		else if(touche.right)// Touche droite préssée
		{
			if(posx < (LCD_WIDTH-32))
				posx++;					
		}
	

			
		if(compteur%5==0)// Tir
		{	
			if(GX_SECONDpressed())
			{
				tir_ok = 1;
			}
		}
		
		if(tir_ok == 1)// Si tir = OK
		{
			for(i=0 ; i<(TIR_MAX-1) ; i++)
			{
				if(tir[i].posx > LCD_WIDTH)
				{
					tir[i].posx = (posx+32);
					tir[i].posy = (posy+8);			
					break;		
				}
			}
			tir_ok = 0;
		}
		
		GX_Clear();// Vider le buffer écran
		GX_Copy(fond);// Ajouter l'écran secondaire à l'écran principale.
		
		/* ===== Afficher les étoiles ===== */
		if(compteur < DESCENTE+200)
		{
			if(compteur%4==0)
			{
				for(i=0 ; i< (ETOILES_MAX-1) ; i++)
				{
					if(etoile[i].posx < (-16))/* Paysage */
					{
						etoile[i].posx = LCD_WIDTH;
						etoile[i].posy = random(LCD_HEIGHT-20);
					}
					etoile[i].posx--;		
				}
			}
			for(i=0 ; i<(ETOILES_MAX-1) ; i++)
				affiche_fond(&etoile[i].posx, &etoile[i].posy);	
			
			/* ===== Afficher l'étoile de la mort ===== */	
			if(mortx > (-33) && compteur%30==0)
				mortx--;
			if(mortx > (-33))
				affiche_planete_mort(&mortx, &morty);					
		}
		

			

		
		
		ennemis();// Mouvements énnemis !
		
		controle_tir();		
		if(compteur > DESCENTE && compteur < DESCENTE+400)// Descente
		{
			//posy++;
			if(compteur < (DESCENTE+200))
				variation = 203;
			else
				variation = 3;			
			for(i=0 ; i<(ETOILES_MAX-1) ; i++)
				etoile[i].posy--;
			for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
			{
				ennemi[i].posy--;	
				ennemi[i].tiry--;			
			}

			morty--;
			(posy > ((LCD_HEIGHT/2)-16)) ? posy-- : posy++;
			(posx > 10) ? posx-- : posx++;

			if(compteur == (DESCENTE+200))
			{
				GX_Clear();
				affichage(&posx, &posy, 202);	
				GX_DisplayWorkBuffer();		
				for(explocompt=0 ; explocompt<3000 ; explocompt++)
					for(i=0 ; i<600 ; i++);				
				for(i=(-32) ; (i<LCD_WIDTH+33); i++)
				{
					GX_Clear();
					i-=10;
					affichage(&posx, &posy, 202);
					explocompt = 1;
					affichage(&i, &explocompt, 202);
					explocompt = 60;
					i+=10;
					affichage(&i, &explocompt, 202);
					i-=30;
					explocompt = 10;
					affichage(&i, &explocompt, 202);
					explocompt = 20;
					i+=30;
					affichage(&i, &explocompt, 202);					
					
					GX_DisplayWorkBuffer();
					for(explocompt=0 ; explocompt<10000 ; explocompt++)	;			
				}
				/*for(i=(-32) ; (i<LCD_WIDTH+33) ; i++)
				{
					GX_Clear();
					affichage(&posx, &posy, 202);
					explocompt = 10;
					i-=30;
					affichage(&i, &explocompt, 202);
					explocompt = 20;
					i+=30;
					affichage(&i, &explocompt, 202);
					GX_DisplayWorkBuffer();
					for(explocompt=0 ; explocompt<10000 ; explocompt++)	;			
				}		*/
				for(explocompt=0 ; explocompt<3000 ; explocompt++)
					for(i=0 ; i<500 ; i++);				
				for(i=(-32) ; (i<LCD_WIDTH+150) ; i++)
				{
					GX_Clear();
					affichage(&posx, &posy, 202);
					explocompt = 10;
					affichage(&i, &explocompt, 202);
					explocompt = 20;
					i-=20;
					affichage(&i, &explocompt, 202);
					explocompt = 30;
					i-=30;
					affichage(&i, &explocompt, 202);
					explocompt = 60;
					i+=10;
					affichage(&i, &explocompt, 202);
					explocompt = 90;
					i+=20;
					affichage(&i, &explocompt, 202);
					explocompt = 33;
					i-=60;
					affichage(&i, &explocompt, 202);
					explocompt = 67;
					i+=70;
					affichage(&i, &explocompt, 202);
					explocompt = 0;
					i-=10;
					affichage(&i, &explocompt, 202);
					i+=20;															
					GX_DisplayWorkBuffer();
					for(explocompt=0 ; explocompt<10000 ; explocompt++)	;			
				}								
				for(explocompt=0 ; explocompt<3000 ; explocompt++)
					for(i=0 ; i<200 ; i++);				
				
				for(i=posx ; (i<LCD_WIDTH+3); i++)
				{
					GX_Clear();
					affichage(&i, &posy, 202);
					GX_DisplayWorkBuffer();
					for(explocompt=0 ; explocompt<10000 ; explocompt++)	;			
				}					
				for(i=(-150) ; i<(LCD_WIDTH+3); i++)
				{
					GX_Clear();
					i-=50;
					if(i<posx)
						affichage(&i, &posy, 2);		
					else
						affichage(&posx, &posy, 2);
					i+=50;
					posy+=20;
					affichage(&i, &posy, 2);		
					i+=30;								
					posy-=30;
					affichage(&i, &posy, 2);	
					i+=60;								
					posy+=10;
					affichage(&i, &posy, 2);	
					i+=10;	
					posy-=40;							
					affichage(&i, &posy, 2);
					i-=100;	
					posy+=10;
					affichage(&i, &posy, 2);																				
					posy+=30;
					GX_DisplayWorkBuffer();
					for(explocompt=0 ; explocompt<10000 ; explocompt++)	;			
				}												
				for(explocompt=0 ; explocompt<3000 ; explocompt++)
					for(i=0 ; i<300 ; i++);				

				minvar-=200;
				maxvar-=200;
				variation-=200;				
			}

		//	if(compteur&2)// posy++;
		}
			
		affichage(&posx, &posy, variation);
		
		/* Tirs */
		for(i=0 ; i<(TIR_MAX-1) ; i++)
		{
			if(tir[i].posx < (LCD_WIDTH+1))
			{
				tir[i].posx+=5;				
				//tir[i].posy = tir[i].posy + (variation-2);
				affichage(&tir[i].posx, &tir[i].posy, 5);
			}
		}				
		
		if(exploennemi != (-1))
		{
			affichage(&ennemi[exploennemi].tracex, &ennemi[exploennemi].tracey, explocompt);
			if(compteur%5==0)
			{
				if(explocompt<104)
					explocompt++;
				else
					exploennemi = (-1);
			}
		}		
		
		controle_collision(&posx, &posy);
		
	//	GX_DrawStr(LCD_MEM, posx, posy, buffer_vie, TRUE);		
	
		
		GX_DisplayWorkBuffer();		
		compteur++;
		/*for(i=0 ; i<3000 ; i++)
			for(j=0 ; j<20 ; j++);*/
	
	}
	
	GX_PowerOff(TRUE);
	ClrScr();
	FontSetSys(F_8x10);
	DrawStrXY(10, 1, "Version alpha 0.1", A_REVERSE);
	FontSetSys(F_6x8);
	DrawStrXY(10, 30, "Programmé par", A_REVERSE);
	DrawStrXY(38, 40, "Vincent Corfdir", A_NORMAL);
	DrawStrXY(10, 50, "Menu en préparation", A_REVERSE);
	DrawStrXY(45, 60, "Onur Celebi", A_NORMAL);	 
	DrawStrXY(28, 80, "Orage Studio 2003", A_NORMAL);
	ngetchx();
	ngetchx();
	return;
}


/* Déplacements des énnemis */

void ennemis(void)
{
	static short i, var_tir[ENNEMIS_MAX];
								 
	if((compteur > /*100*/DEPART_1) && (compteur < DEPART_2))// Ennemis de type '1'
	{
		for(i=0 ; i<(ENNEMI_TYPE_1/*-1*/) ; i++)
		{
			if(ennemi[i].posx>(-16))
			{
				if(compteur < DEPART_5)
					affichage(&ennemi[i].posx, &ennemi[i].posy, 10);
				else 
					affichage(&ennemi[i].posx, &ennemi[i].posy, 19);
						
				if(compteur&2)
					ennemi[i].posx--;				
	
				if(ennemi[i].vie < 1)
				{
						explocompt = 100;
						exploennemi = i;
						ennemi[i].tracex = ennemi[i].posx;
						ennemi[i].tracey = ennemi[i].posy;
						ennemi[i].posx = -30;								
				}
				
				if(ennemi[i].posx == (LCD_WIDTH/2)+30)
				{
					ennemi[i].tirx = ennemi[i].posx;
					ennemi[i].tiry = ennemi[i].posy;
				}
				if(ennemi[i].tirx > (-16))
				{
					ennemi[i].tirx-=2;			
					affichage(&ennemi[i].tirx, &ennemi[i].tiry, 5);		
				}
				else if((compteur > DEPART_5)&&(compteur%20==0))
				{
					ennemi[i].tirx = ennemi[i].posx;
					ennemi[i].tiry = ennemi[i].posy;
				}
			}
			else
			{
				if((compteur < (DEPART_5-(3*LCD_WIDTH)))||(compteur > DEPART_5))
				{			
					ennemi[i].posx = (LCD_WIDTH)+random(LCD_WIDTH);
					ennemi[i].posy = random(LCD_HEIGHT-32);
					ennemi[i].vie = 6;
				}
			}
			
		}
	}
	else if((compteur > /*600*/DEPART_2) && (compteur<DEPART_3))// Ennemi de type '2' (bi-ped)
	{
		if(compteur%20 == 0)
		{
			if(pas_mode == 16)
				pas_mode = 11;			
			pas_mode++;	
		}	

		if(compteur == /*601*/(DEPART_2+1))// Pour les suivants
		{
			for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
			{
				ennemi[i].posx = (-50);
				ennemi[i].posy = LCD_HEIGHT-55/*45*/;
			}
			maxy = 30;
		}	
		
		for(i=0 ; i<(ENNEMI_TYPE_2/*-1*/) ; i++)
		{
			if(ennemi[i].vie < 1)
			{
				explocompt = 100;
				exploennemi = i;
				ennemi[i].tracex = ennemi[i].posx;
				ennemi[i].tracey = ennemi[i].posy;
				ennemi[i].posx = (-40);								
				ennemi[i].vie = 1;
			}			
		
			if(compteur%4==0)
			{		
				if(ennemi[i].posx > (-40))
					ennemi[i].posx--;
				else
				{
					if((compteur < (DEPART_3-(5*LCD_WIDTH))))
					{				
						ennemi[i].posx = LCD_WIDTH+random(LCD_WIDTH);
						ennemi[i].posy = LCD_HEIGHT-55/*45*/;						
						ennemi[i].vie = 20;
					}
				}										
			}
			affichage(&ennemi[i].posx, &ennemi[i].posy, 11);
			affichage(&ennemi[i].posx, &ennemi[i].posy, pas_mode);
			if(ennemi[i].posx < LCD_WIDTH)
			{
				if(ennemi[i].tirx > (-200))
				{
					ennemi[i].tirx-=2;		
					affichage(&ennemi[i].tirx, &ennemi[i].tiry, 5);		
				}
	
				else
				{
					ennemi[i].tirx = ennemi[i].posx;
					ennemi[i].tiry = ennemi[i].posy;
				}						
			}	
		}			
	}
	else if((compteur > /*600*/DEPART_3) && (compteur<DEPART_4))//  Ennemi de type '3' (capsule)
	{
		if(compteur == /*601*/(DEPART_3+1))// Pour les suivants
		{
			for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
			{
				ennemi[i].posx = (-50);
				ennemi[i].tirx = (-30);
				var_tir[i] = 0;
			}
			maxy = 12;			
		}	
		
		for(i=0 ; i<(ENNEMI_TYPE_3/*-1*/) ; i++)
		{
			if(ennemi[i].vie < 1)
			{
				explocompt = 100;
				exploennemi = i;
				ennemi[i].tracex = ennemi[i].posx;
				ennemi[i].tracey = ennemi[i].posy;
				ennemi[i].posx = (-40);								
				ennemi[i].vie = 1;
			}					
			if(compteur%4==0)
			{
				if(ennemi[i].posx > (2*LCD_WIDTH/3))
					ennemi[i].posx--;
				else if(ennemi[i].posx < 0)
				{
					if((compteur < (DEPART_4-LCD_WIDTH)))
					{				
						ennemi[i].posx = LCD_WIDTH+random(LCD_WIDTH);
						ennemi[i].posy = random(LCD_HEIGHT-42);
						ennemi[i].vie = 10;
					}
				}										
			}
			affichage(&ennemi[i].posx, &ennemi[i].posy, 17);

			if(ennemi[i].posx < LCD_WIDTH)
			{
				if(ennemi[i].tirx > (-16))
				{
					ennemi[i].tirx-=2;		
					if(compteur&2)
						ennemi[i].tiry = ennemi[i].tiry + var_tir[i];
					affichage(&ennemi[i].tirx, &ennemi[i].tiry, 5);		
				}
				else if(compteur%20==0)
				{
					ennemi[i].tirx = ennemi[i].posx;
					ennemi[i].tiry = ennemi[i].posy;
					var_tir[i] = random(3);
					var_tir[i]--;
				}						
			}	
		}			
	}
	else if(compteur > /*600*/DEPART_4)//  Ennemi de type '4' (soldats)
	{
		if(compteur == /*601*/(DEPART_4+1))// Pour les suivants
		{
			for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
			{
				ennemi[i].posx = (-50);
				ennemi[i].tirx = (-30);
				var_tir[i] = 0;
			}
			maxy = 18;
		}	
		
		for(i=0 ; i<(ENNEMI_TYPE_4/*-1*/) ; i++)
		{
			if(ennemi[i].vie < 1)
			{
				explocompt = 100;
				exploennemi = i;
				ennemi[i].tracex = ennemi[i].posx;
				ennemi[i].tracey = ennemi[i].posy;
				ennemi[i].posx = (-40);					
				ennemi[i].vie = 1;			
			}			
			if(compteur%4==0)
			{		
				if(ennemi[i].posx > (-32))
					ennemi[i].posx--;
				else
				{
					ennemi[i].posx = LCD_WIDTH+random(LCD_WIDTH);
					ennemi[i].posy = /*LCD_WIDTH-20+random(10)*/50+random(10);
					ennemi[i].vie = 2;
				}										
			}
			affichage(&ennemi[i].posx, &ennemi[i].posy, 18);

			if(ennemi[i].posx < LCD_WIDTH)
			{
				if(ennemi[i].tirx > (-16))
				{
					ennemi[i].tirx-=2;		
					if(compteur&2)
						ennemi[i].tiry = ennemi[i].tiry - var_tir[i];
					affichage(&ennemi[i].tirx, &ennemi[i].tiry, 5);		
				}
				else
				{
					ennemi[i].tirx = ennemi[i].posx;
					ennemi[i].tiry = ennemi[i].posy;
					var_tir[i] = random(2);
				}						
			}	
		}			
	}
	
}

void controle_tir(void)
{
	static short i, j;
	for(i=0 ; i< (/*ENNEMI_TYPE_1*/ENNEMIS_MAX-1)/*3*/ ; i++)
	{
		for(j=0 ; j < (TIR_MAX-1) ; j++)
		{
			if(tir[j].posx < LCD_WIDTH)
			{
				if((tir[j].posx > (ennemi[i].posx-10)) && (tir[j].posx < (ennemi[i].posx+10)))
				{				
					if((tir[j].posy > (ennemi[i].posy-10)) && (tir[j].posy < (ennemi[i].posy+/*10*/maxy)))
					{
						ennemi[i].vie--;
						tir[j].posx = (LCD_WIDTH+1);
					}
				}					
			}
		}
	}
}

void controle_collision(short *posx, short *posy)
{
	static short i;
	for(i=0 ; i<(ENNEMIS_MAX-1) ; i++)
	{
		//if(ennemi[i].posx > (-10))
		//{
			if((*posx > (ennemi[i].posx-25)) && (*posx < (ennemi[i].posx+5)))
			{				
				if((*posy > (ennemi[i].posy-/*miny*/20)) && (*posy < (ennemi[i].posy+/*10*/maxy)))// Si collision avec un appareil
				{
					ennemi[i].vie = 0;	
					collision(4);
				}
			}				
	//	}
	
		if(ennemi[i].tirx > (-10))
		{
			if((*posx > (ennemi[i].tirx-10)) && (*posx < (ennemi[i].tirx+10)))
			{				
				if((*posy > (ennemi[i].tiry-20)) && (*posy < (ennemi[i].tiry+3/*6*/)))// Si collision avec un tir
				{
					ennemi[i].tirx = (-40);	
					collision(2);
				}
			}				
		}
						
	}
}

void collision(short puissance)
{
	vie--;
	//short hauteur=95;
	for(explocompt=100 ; explocompt<120 ; explocompt++)
	{	
		if(explocompt&2)
			GX_VerticalScroll(puissance);
		else
			GX_VerticalScroll(-puissance);
		GX_DisplayWorkBuffer();
	}
	/*for(explocompt = 104 ; explocompt > 101 ; explocompt--)
	{
		GX_VerticalScroll(-2);		
		GX_DisplayWorkBuffer();
	}*/
	GX_SetWorkBuffer(fond);
	GX_Clear();	
	for(explocompt = 0 ; explocompt < (10*vie) ; explocompt+=10)
	{
		affichage(&explocompt, &explocompt, 105);
	}	
	GX_SetWorkBuffer(ecr);	
//	sprintf(buffer_vie, "VIE : %03d", vie);			
	if(vie < 0)
		quitte = 1;
}

void affichage(short *x, short *y, short choix)
{
	GX_sprite_08_nomask *vie = (GX_sprite_08_nomask *)vie_data;
	GX_sprite_16_nomask *ex4 = (GX_sprite_16_nomask *)ex4_data;
	GX_sprite_16_nomask *ex3 = (GX_sprite_16_nomask *)ex3_data;
	GX_sprite_16_nomask *ex2 = (GX_sprite_16_nomask *)ex2_data;
	GX_sprite_16_nomask *ex1 = (GX_sprite_16_nomask *)ex1_data;				
	GX_sprite_16_masked *laser = (GX_sprite_16_masked *)laser_data;	
	GX_sprite_16_masked *ennemi5 = (GX_sprite_16_masked *)ennemi5_data;
	GX_sprite_16_masked *ennemi4 = (GX_sprite_16_masked *)ennemi4_data;
	GX_sprite_16_masked *ennemi3 = (GX_sprite_16_masked *)ennemi3_data;
	GX_sprite_16_masked *ennemi1 = (GX_sprite_16_masked *)ennemi1_data;	
	GX_sprite_32_masked *tete = (GX_sprite_32_masked *)tete_data;				
	GX_sprite_32_masked *jambes5 = (GX_sprite_32_masked *)jambes5_data;
	GX_sprite_32_masked *jambes4 = (GX_sprite_32_masked *)jambes4_data;
	GX_sprite_32_masked *jambes3 = (GX_sprite_32_masked *)jambes3_data;
	GX_sprite_32_masked *jambes2 = (GX_sprite_32_masked *)jambes2_data;
	GX_sprite_32_masked *jambes1 = (GX_sprite_32_masked *)jambes1_data;		
	GX_sprite_32_masked *a_bas = (GX_sprite_32_masked *)a_bas_data;	
	GX_sprite_32_masked *a_haut = (GX_sprite_32_masked *)a_haut_data;	
	GX_sprite_32_masked *a_horizon = (GX_sprite_32_masked *)a_horizon_data;	
	GX_sprite_32_masked *b_haut = (GX_sprite_32_masked *)b_haut_data;
	GX_sprite_32_masked *b_horizon = (GX_sprite_32_masked *)b_horizon_data;	
	GX_sprite_32_masked *b_bas = (GX_sprite_32_masked *)b_bas_data;	
	switch(choix)
	{
		case 1:
			GX_PutSprite32_MS(b_haut, *x, *y);
			break;
		case 2:
				GX_PutSprite32_MS(b_horizon, *x, *y);
			break;
		case 3:
			GX_PutSprite32_MS(b_bas, *x, *y);
			break;						
		case 5:
			GX_PutSprite16_MS(laser, *x, *y);
			break;
		case 10:
			GX_PutSprite16_MS(ennemi1, *x+3, *y+3);
			GX_PutSprite16_MS(ennemi1, *x, *y);			
			break;
		case 11:
			GX_PutSprite32_MS(tete, *x, (*y-20));
			break;
		case 12:
			GX_PutSprite32_MS(jambes1, *x, (*y+12));
			break;	
		case 13:
			GX_PutSprite32_MS(jambes2, (*x+8), (*y+12));
			break;
		case 14:
			GX_PutSprite32_MS(jambes3, (*x+8), (*y+12));
			break;		
		case 15:
			GX_PutSprite32_MS(jambes4, (*x+8), (*y+12));
			break;
		case 16:
			GX_PutSprite32_MS(jambes5, (*x+6), (*y+12));
			break;		
		case 17:
			GX_PutSprite16_MS(ennemi3, *x, *y);
			break;
		case 18:
			GX_PutSprite32_MX(ennemi4, *x, *y);
			break;			
		case 19:
			GX_PutSprite16_MS(ennemi5, *x, *y);
			GX_PutSprite16_MS(ennemi5, *x+3, *y+3);			
			break;			
		case 100:
			GX_PutSprite16_MX(ex1, *x, *y);
			break;
		case 101:
			GX_PutSprite16_MX(ex2, *x, *y);
			break;
		case 102:
			GX_PutSprite16_MX(ex3, *x, *y);
			break;
		case 103:
			GX_PutSprite16_MX(ex4, *x, *y);
			break;					
		case 105:
			GX_PutSprite08_MX(vie, *x, 92);
			break;	
		case 201:
			GX_PutSprite32_MS(a_haut, *x, *y);
			break;
		case 202:
			GX_PutSprite32_MS(a_horizon, *x, *y);
			break;
		case 203:
			GX_PutSprite32_MS(a_bas, *x, *y);
			break;								
		default:
			break;
	}
}

void affiche_fond(short *x, short *y)
{
	GX_sprite_08_nomask *etoile = (GX_sprite_08_nomask *)etoile_data;

	GX_PutSprite08_MX(etoile, *x, *y);
}

void affiche_planete_mort(short *x, short *y)
{
	/* Planete de la mort */
	static long plenete_mort_data[] = {0x00000000,0x00000000,0x00000000,0x0007F000,0x00000000,0x003FFE00,0x00009700,0x003F6800,0x00009300,0x000F6C00,0x00003980,0x0007C600,0x0000FCC0,0x00010B20,0x00003FE0,0x0041D250,0x00003FF0,0x01E3DF80,0x00007FE0,0x01FB8010,0x000007E0,0x00FFF850,0x000007F0,0x18FFF988,0x00001FD8,0x19FFE124,0x00007FFC,0x1FEF8008,0x00003DFC,0x0DC3C23E,0x00007FFE,0x0F8380F0,0x00007FFE,0x2F6080E0,0x00000FFC,0x3FFCF05E,0x06000FFC,0x19FFF006,0x00413FFC,0x1FBEC012,0x0001FFFC,0x1FFE0000,0x00001FF8,0x1FFFE024,0x0400DFF0,0x0BFF2068,0x06F9FF80,0x090680C0,0x027FFF80,0x05ABCF00,0x0007FF00,0x03F9DF00,0x0183FF80,0x027C0F00,0x00C3FF80,0x013C0300,0x0077FF00,0x00881A00,0x003FFC00,0x00081E00,0x0007F000,0x0008C800,0x00000000,0x00000000};
	GX_sprite_32_nomask *plenete_mort = (GX_sprite_32_nomask *)plenete_mort_data;
	
	GX_PutSprite32_MX(plenete_mort, *x, *y);	
}
